from pybricks.hubs import PrimeHub
from pybricks.pupdevices import Motor, ColorSensor, UltrasonicSensor, ForceSensor
from pybricks.parameters import Button, Color, Direction, Port, Side, Stop
from pybricks.robotics import DriveBase
from pybricks.tools import wait, StopWatch

tempo = StopWatch()
hub = PrimeHub()
direito = Motor(Port.A)
esquerdo = Motor(Port.F, Direction.COUNTERCLOCKWISE)
garra_esq = Motor(Port.D, Direction.COUNTERCLOCKWISE)
garra_dir = Motor(Port.C)
mover = DriveBase(esquerdo, direito, 54, 76)
mover.use_gyro(True)
numero = 1
lancamento = 1
hub.system.set_stop_button(Button.BLUETOOTH)

def andar(distancia, velocidade = 300):
    mover.settings(velocidade, 900, 230, 300)
    mover.straight(distancia*10)

def curva(graus):
    mover.settings(50, 600, 130, 200)
    mover.turn(graus)
    
def garraD(velocidade, tempo):
    garra_dir.run_time(velocidade, tempo)

def garraE(velocidade, tempo):
    garra_esq.run_time(velocidade, tempo)
    
def esperar(tempo):
    mover.stop()
    wait(tempo*1000)
    mover.stop()

while numero == 1:

    hub.display.number(lancamento)
    botao = hub.buttons.pressed()
    
    if Button.LEFT in botao: 

        if lancamento == -99:

            lancamamento = -99
            hub.display.number(lancamento)

        else:

            lancamento -= 1
            hub.display.number(lancamento)
            wait(250)
    
    if Button.RIGHT in botao:

        if lancamento == 99:

            lancamento = 99

        else:

            lancamento += 1
            hub.display.number(lancamento)
            wait(250)

    if Button.CENTER in botao:
        
        wait(300)

        if lancamento == -3:

            curva(10)
            garraE(-4000, 1600)
            garraE(350, 1070)
            andar(47.5)
            curva(-56)
            andar(17)
            garraE(350, 1070)
            garraE(-4000, 250)
            curva(190)
            andar(14)
            curva(-117)
            garraE(-4000, 740)
            garraE(4000, 480)
            andar(22)
            garraE(-4000, 770)
            andar(-77)
            print('Bateria:', hub.battery.voltage)
            print('Tempo:', tempo/1000)
            mover.stop()

        if lancamento == -2:

            andar(89.5)
            curva(94)
            andar(-4.5)
            garraE(-600, 2400)
            andar(-3)
            garraE(4000, 1000)
            andar(2.5)
            curva(5)
            esperar(1)
            garraE(501, 2000)
            andar(5.5)
            curva(188)
            andar(-5.7)
            garraE(-700, 2700)
            curva(-10)
            garraE(700, 2000)
            curva(-99)
            garraD(-500, 1700)
            andar(31.5)
            curva(100)
            andar(17.5)
            andar(-15)
            curva(-78)
            andar(65)
            print('Bateria:', hub.battery.voltage)
            print('Tempo:', tempo/1000)
            mover.stop()
        
        if lancamento == -1:

            curva(53)
            andar(-62)
            andar(25)
            curva(-81)
            andar(-50)
            curva(20)
            andar(53)
            curva(-151)
            garraE(-4000, 1500)
            andar(23)
            garraE(4000, 850)
            curva(169)
            andar(-27)
            andar(10)
            curva(45)
            andar(50)
            print('Bateria:', hub.battery.voltage)
            print('Tempo:', tempo/1000)
            mover.stop()

        if lancamento == 0:

            print('Bateria:', hub.battery.voltage())
            andar(10000)

        if lancamento == 1:

            andar(-10)
            curva(-30)
            andar(-30)
            curva(35)
            andar(-17)
            curva(-34)
            andar(-15)
            curva(90)
            andar(-14.5)
            curva(-180)
            andar(-15)
            curva(-80)
            andar(-60)
            print('Bateria:', hub.battery.voltage)
            print('Tempo:', tempo/1000)
            mover.stop()

        if lancamento == 2:

            garraE(4000, 1500)
            curva(-39)
            andar(21)
            curva(49)
            garraD(4000, 530)
            andar(27)
            garraD(700, 1300)
            curva(45)
            garraD(-4000, 500)
            andar(-17)
            curva(-25)
            garraD(4000, 1000)
            andar(36)
            curva(63)
            andar(-2)
            garraE(-3000, 1700)
            curva(-75)
            andar(-30)
            curva(105)
            andar(-40)
            andar(5)
            curva(20)
            andar(50)
            print('Bateria:', hub.battery.voltage)
            print('Tempo:', tempo/1000)
            mover.stop()

        if lancamento == 3:

            andar(72)
            garraE(-3000,900)
            curva(-100)
            andar(42)
            andar(-7)
            curva(55)
            andar(15)
            garraD(-3000, 3000)
            andar(9)
            garraD(3000, 3500)
            andar(-6)
            curva(-180)
            andar(15)
            curva(-130)
            andar(30)
            curva(90)
            andar(64)
            print('Bateria:', hub.battery.voltage)
            print('Tempo:', tempo/1000)
            mover.stop()
